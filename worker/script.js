!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;const r=n(1),o=n(2),s=n(3);function a(e){return!(e instanceof Map)}function i(e){if(!a(e))throw new Error("Implementation Error")}t.Router=class{constructor(e={}){var t;this.staticRoutes=new Map,this.dynamicRouteTree=new Map(s.METHODS.map(e=>[e,new Map])),this.fallbackHandler=null!==(t=e.fallback)&&void 0!==t?t:r.handleRequest}createStaticRouteMapKey(e,t){return`${e.toLowerCase()}::${t}`}checkIsAppendingPathValid(e){return/^\/(?:\:?[0-9a-zA-Z_\-.~]+\/?)*\*?$/.test(e)}findDynamicRoute(e,t){var n;const r=[e.toLowerCase(),...t.split("/"),"\0"],o=()=>e!==s.METHOD_ANY?this.findDynamicRoute(s.METHOD_ANY,t):null;let u=this.dynamicRouteTree;for(let e of r){const t=null!==(n=u.get(e))&&void 0!==n?n:u.get(":");if(null==t){const e=u.get("*");return null!=e?(i(e),e):o()}if(a(t))return t;u=t}return o()}appendRoute(e,t,n){if(!this.checkIsAppendingPathValid(t))throw new Error(`can not append path "${t}"`);if(/[:\*]/.test(t))this.appendDynamicRoute(e,t,n);else{const r=this.createStaticRouteMapKey(e,t);if(this.staticRoutes.has(r))throw new Error("static path config duplicated "+t);this.staticRoutes.set(this.createStaticRouteMapKey(e,t),{method:e,path:t,handler:n})}}appendDynamicRoute(e,t,n){var r;const s=[e.toLowerCase(),...t.split("/").map(e=>"*"===e?"*":e.startsWith(":")?":":e),"\0"];let i=this.dynamicRouteTree;for(let u of s)if("*"===u||"\0"===u){if(null!=i.get(u))throw new Error("dynamic path config duplicated "+t);i.set(u,{method:e,rawPath:t,tests:o.createPathTestFragments(t),handler:n})}else{const e=null!==(r=i.get(u))&&void 0!==r?r:new Map;if(a(e))throw new Error("Implementation Error");i.set(u,e),i=e}}async resolveRequest(e){var t;const{method:n}=e,{pathname:r}=new URL(e.url);{const o=null!==(t=this.staticRoutes.get(this.createStaticRouteMapKey(n,r)))&&void 0!==t?t:this.staticRoutes.get(this.createStaticRouteMapKey(s.METHOD_ANY,r));if(null!=o)return o.handler(e)}{const t=this.findDynamicRoute(n,r);if(null!=t){const n=o.resolveDynamicPath(r,t.tests);if(null!=n)return t.handler(e,n)}}return this.fallbackHandler(e)}get(e,t){return this.appendRoute("get",e,t)}post(e,t){return this.appendRoute("post",e,t)}patch(e,t){return this.appendRoute("patch",e,t)}delete(e,t){return this.appendRoute("delete",e,t)}option(e,t){return this.appendRoute("option",e,t)}head(e,t){return this.appendRoute("head",e,t)}trace(e,t){return this.appendRoute("trace",e,t)}any(e,t){return this.appendRoute(s.METHOD_ANY,e,t)}async handle(e){return this.resolveRequest(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleRequest=void 0,t.handleRequest=function(e){return fetch(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveDynamicPath=t.createPathTestFragments=void 0;const r=/^:(?<name>[a-zA-Z0-9_]+)$/;t.createPathTestFragments=e=>e.split("/").reduce((e,t)=>{var n,o;"*"===t&&e.push({type:"ignore_after"});const s=null===(o=null===(n=t.match(r))||void 0===n?void 0:n.groups)||void 0===o?void 0:o.name;return null==s?(e.push({type:"static",name:t}),e):(e.push({type:"dynamic",name:s}),e)},[]),t.resolveDynamicPath=(e,t)=>{const n=e.split("/");let r={};const o=n.length;for(let e=0;e<o;e++){const o=n[e],s=t[e];if("static"!==s.type){if("ignore_after"===s.type)return r;if("dynamic"===s.type){if(0===o.length)return null;r[s.name]=o}}else if(s.name!==o)return null}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.METHODS=t.METHOD_ANY=void 0,t.METHOD_ANY="any",t.METHODS=[t.METHOD_ANY,"get","post","patch","delete","option","head","trace"]},function(e,t,n){"use strict";n.r(t);var r=n(0);const o={accessControl:{allowOrigin:"*",allowMethods:"GET, POST, PUT",allowHeaders:"Content-Type"},_corsHeaders(){return{"Access-Control-Allow-Origin":this.accessControl.allowOrigin,"Access-Control-Allow-Methods":this.accessControl.allowMethods,"Access-Control-Max-Age":"1728000"}},_genericResponse(e,t,n){if(void 0===n)n={};var r=n.headers||{},o=n.status||200,s=n.statusText||"OK",a=n.autoCors;void 0===n.autoCors&&(a=!0);var i={"Content-Type":e,...r};return a&&(i={...i,...this._corsHeaders()}),new Response(t,{status:o,statusText:s,headers:i})},cors(){return new Response(null,{headers:this._corsHeaders()})},json(e,t){var n=e;return"string"!=typeof n&&(n=JSON.stringify(e)),this._genericResponse("application/json",n,t)},html(e,t){return this._genericResponse("text/html",e,t)}},s=new r.Router;s.get("/json",async e=>o.json({Hello:"world!"})),s.get("/json/:message",async(e,t)=>o.json({message:t.message},{headers:{"x-hello":"world"},status:200})),s.get("/html",async e=>o.html("<b>Hello, world!</b><p>This is a test of the easy-utils HTML response type.</p>")),addEventListener("fetch",e=>"OPTIONS"==e.request.method?e.respondWith(o.cors()):e.respondWith(s.handle(e.request)))}]);